<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EthosiFi ‚Äî Proof of Ethics, On-Chain</title>
  <!-- Ethers.js for on-chain verification -->
  <script src="https://cdn.ethers.io/lib/ethers-5.7.2.umd.min.js" type="application/javascript"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --teal: #6ee7b7;
      --teal-dark: #0d9488;
      --bg-dark: #0a0f1a;
      --panel: rgba(15, 23, 42, 0.85);
      --border: rgba(13, 148, 136, 0.3);
      --verified: #34d399;
      --unverified: #f87171;
    }
    body {
      background: var(--bg-dark);
      color: #e2e8f0;
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    #matrixCanvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
    }

    .container {
      position: relative;
      z-index: 2;
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }

    .page { display: none; }
    .page.active { display: block; animation: fadeIn 0.4s ease; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 1.5rem;
      backdrop-filter: blur(10px);
    }

    h1, h2, h3 {
      margin-bottom: 1.2rem;
      line-height: 1.2;
    }
    h1 {
      font-size: 2.2rem;
      background: linear-gradient(90deg, var(--teal-dark), var(--teal));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    h2 { font-size: 1.4rem; color: var(--teal); }
    h3 { font-size: 1.2rem; }

    p { margin-bottom: 1rem; line-height: 1.6; }
    .highlight { color: var(--teal); font-weight: 600; }

    .btn {
      display: inline-block;
      padding: 0.8rem 1.8rem;
      background: linear-gradient(90deg, var(--teal-dark), #0f766e);
      color: white;
      border: none;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      margin: 0.5rem 0.3rem;
      transition: transform 0.2s, box-shadow 0.3s;
      text-decoration: none;
      text-align: center;
    }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(13, 148, 136, 0.4); }
    .btn-outline {
      background: transparent;
      border: 2px solid var(--teal);
      color: var(--teal);
    }

    .form-group { margin-bottom: 1.2rem; }
    label {
      display: block;
      margin-bottom: 0.4rem;
      font-weight: 600;
    }
    input, textarea, select {
      width: 100%;
      padding: 0.7rem;
      background: rgba(0,0,0,0.3);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: white;
      font-family: inherit;
    }
    input:focus, textarea:focus {
      outline: 2px solid var(--teal);
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1.2rem;
      margin-top: 1.5rem;
    }
    .metric-card {
      background: rgba(10, 18, 35, 0.7);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.2rem;
      text-align: center;
    }
    .score-display {
      font-size: 2.2rem;
      font-weight: 800;
      background: linear-gradient(90deg, var(--teal-dark), var(--teal));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin: 0.5rem 0;
    }

    .trust-row {
      display: flex;
      justify-content: space-between;
      margin: 0.6rem 0;
      font-size: 0.95rem;
    }
    .trust-label { opacity: 0.8; }
    .trust-status-verified { color: var(--verified); }
    .trust-status-unverified { color: var(--unverified); }

    .nft-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    .nft-option {
      background: rgba(0,0,0,0.4);
      border: 2px solid transparent;
      border-radius: 8px;
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: border-color 0.3s;
    }
    .nft-option.selected { border-color: var(--teal); }
    .nft-option img {
      max-width: 80%;
      max-height: 80%;
    }

    .banner {
      background: rgba(13, 148, 136, 0.15);
      border-left: 4px solid var(--teal);
      padding: 0.8rem 1.2rem;
      margin-bottom: 1.5rem;
      border-radius: 0 8px 8px 0;
      font-size: 0.95rem;
      font-weight: 600;
    }

    .footer {
      text-align: center;
      opacity: 0.6;
      font-size: 0.9rem;
      margin-top: 3rem;
    }

    a { color: var(--teal); text-decoration: underline; }
    ul { padding-left: 1.5rem; margin: 0.8rem 0; text-align: left; }

    @media (max-width: 600px) {
      h1 { font-size: 1.8rem; }
      .panel { padding: 1.5rem; }
      .btn { width: 100%; margin: 0.4rem 0; }
      .dashboard-grid { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>
  <canvas id="matrixCanvas"></canvas>

  <div class="banner">
    ‚ö†Ô∏è All scores and verification statuses are simulated. Actual data will be live on X1 testnet.
  </div>

  <div class="container">
    <!-- LOGIN PAGE -->
    <div id="loginPage" class="page active">
      <div class="panel">
        <h1>Welcome to EthosiFi</h1>
        <p>Verify integrity through action ‚Äî not hype.</p>
        <div style="text-align: center; margin-top: 1.5rem;">
          <div class="btn" onclick="showPage('builderLogin')">Log in as Builder</div>
          <div class="btn" onclick="showPage('investorLogin')">Log in as Investor</div>
          <div class="btn btn-outline" onclick="showPage('signupPage')">Create Account</div>
          <div class="btn btn-outline" onclick="showPage('reportScam')">Report Scam</div>
          <div class="btn btn-outline" onclick="showPage('verifyWallet')">Verify Wallet</div>
        </div>
      </div>
    </div>

    <!-- BUILDER LOGIN -->
    <div id="builderLogin" class="page">
      <div class="panel">
        <h2>Builder Login</h2>
        <p>Connect your wallet or sign in to manage your project‚Äôs Ethoscan Score.</p>
        <div style="text-align: center; margin-top: 1.5rem;">
          <button class="btn" onclick="showPage('builderForm')">Continue to Profile</button>
          <button class="btn btn-outline" onclick="showPage('loginPage')">Back</button>
        </div>
      </div>
    </div>

    <!-- SIGN UP -->
    <div id="signupPage" class="page">
      <div class="panel">
        <h2>Create Your Account</h2>
        <div class="form-group">
          <label>Email</label>
          <input type="email" placeholder="you@project.com">
        </div>
        <div class="form-group">
          <label>Role</label>
          <select>
            <option>Builder</option>
            <option>Investor</option>
          </select>
        </div>
        <div class="form-group">
          <button class="btn" onclick="showPage('builderForm')">Continue</button>
          <button class="btn btn-outline" onclick="showPage('loginPage')">Back</button>
        </div>
      </div>
    </div>

    <!-- BUILDER FORM -->
    <div id="builderForm" class="page">
      <div class="panel">
        <h2>Builder Profile</h2>
        <div class="form-group">
          <label>Profile Name</label>
          <input type="text" placeholder="e.g., Alex Chen">
        </div>
        <div class="form-group">
          <label>Official Project Name</label>
          <input type="text" placeholder="e.g., EthosiFi">
        </div>
        <div class="form-group">
          <label>Project ENS or Address</label>
          <input type="text" placeholder="ethosifi.eth or 0x...">
        </div>
        <button class="btn" onclick="showPage('consentPage')">Next</button>
      </div>
    </div>

    <!-- CONSENT -->
    <div id="consentPage" class="page">
      <div class="panel">
        <h2>Data Consent</h2>
        <p>By submitting, you allow EthosiFi to:</p>
        <ul>
          <li>Analyze your on-chain behavior for scoring</li>
          <li>Display your Ethoscan Score publicly</li>
          <li>Issue non-transferable reputation NFTs</li>
        </ul>
        <label><input type="checkbox"> I agree to data usage terms</label>
        <div style="margin-top: 1.2rem;">
          <button class="btn" onclick="showPage('nftPage')">Submit & Create NFT</button>
          <button class="btn btn-outline" onclick="showPage('builderForm')">Back</button>
        </div>
      </div>
    </div>

    <!-- NFT SELECTION -->
    <div id="nftPage" class="page">
      <div class="panel">
        <h2>Select Your Reputation NFT Art</h2>
        <p>Choose an EthosiFi-branded image for your non-transferable NFT:</p>
        <div class="nft-grid">
          <div class="nft-option selected"><div style="font-size:3rem;">üõ°Ô∏è</div></div>
          <div class="nft-option"><div style="font-size:3rem;">üîç</div></div>
          <div class="nft-option"><div style="font-size:3rem;">‚úÖ</div></div>
          <div class="nft-option"><div style="font-size:3rem;">üåê</div></div>
        </div>
        <button class="btn" onclick="showPage('builderDashboard')" style="margin-top: 1.5rem;">Finalize & View Dashboard</button>
      </div>
    </div>

    <!-- BUILDER DASHBOARD -->
    <div id="builderDashboard" class="page">
      <div class="panel">
        <h2>Builder Dashboard</h2>
        <p>Welcome back, <span class="highlight">Alex Chen</span>!</p>
        
        <div class="dashboard-grid">
          <div class="metric-card">
            <div>Ethoscan Score</div>
            <div class="score-display">420</div>
            <div>‚úÖ Verified Builder</div>
          </div>
          <div class="metric-card">
            <div>$ETHOS Vault</div>
            <div class="score-display">12,500</div>
            <a href="#" class="btn btn-outline" style="padding:0.4rem; font-size:0.9rem; margin-top:0.5rem;">Buy $ETHOS</a>
          </div>
        </div>

        <h3>Trust Pillars</h3>
        <div class="trust-row">
          <span class="trust-label">Team Transparency</span>
          <span class="trust-status-verified">‚úÖ Verified</span>
        </div>
        <div class="trust-row">
          <span class="trust-label">Liquidity Commitment</span>
          <span class="trust-status-verified">‚úÖ 180 days locked</span>
        </div>
        <div class="trust-row">
          <span class="trust-label">Treasury Safety</span>
          <span class="trust-status-verified">‚úÖ Gnosis Safe</span>
        </div>
        <div class="trust-row">
          <span class="trust-label">Fair Launch Pledge</span>
          <span class="trust-status-verified">‚úÖ Signed</span>
        </div>

        <h3>Suggested Improvement</h3>
        <p>Add a third team member via SIWE to boost Team score by +25 pts.</p>

        <button class="btn" onclick="connectWallet()">Connect Wallet (WalletConnect)</button>
      </div>
    </div>

    <!-- INVESTOR DASHBOARD -->
    <div id="investorLogin" class="page">
      <div class="panel">
        <h2>Investor Dashboard</h2>
        <p>Review projects by behavioral integrity:</p>
        
        <div class="panel" style="background:rgba(10,18,35,0.7); margin-top:1.2rem;">
          <strong>EthosiFi Protocol</strong><br>
          <div style="display:flex; justify-content:space-between; margin:0.6rem 0;">
            <span>Score: <span class="highlight">420</span></span>
            <span>‚úÖ Verified Builder</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">Team Transparency</span>
            <span class="trust-status-verified">‚úÖ Verified</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">LP Locked</span>
            <span class="trust-status-verified">‚úÖ 180 days</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">Treasury</span>
            <span class="trust-status-verified">‚úÖ Gnosis Safe</span>
          </div>
        </div>
        
        <div class="panel" style="background:rgba(10,18,35,0.7);">
          <strong>DeFiShield</strong><br>
          <div style="display:flex; justify-content:space-between; margin:0.6rem 0;">
            <span>Score: <span class="highlight">380</span></span>
            <span>‚úÖ Verified Builder</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">Team Transparency</span>
            <span class="trust-status-verified">‚úÖ Verified</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">LP Locked</span>
            <span class="trust-status-verified">‚úÖ 365 days</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">Treasury</span>
            <span class="trust-status-unverified">‚ö†Ô∏è Not verified</span>
          </div>
        </div>
        
        <div class="panel" style="background:rgba(10,18,35,0.7);">
          <strong>MoonRocket v2</strong><br>
          <div style="display:flex; justify-content:space-between; margin:0.6rem 0;">
            <span>Score: <span class="highlight">120</span></span>
            <span>‚ö†Ô∏è Unverified</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">Team Transparency</span>
            <span class="trust-status-unverified">‚ö†Ô∏è Anonymous</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">LP Locked</span>
            <span class="trust-status-unverified">‚ùå None</span>
          </div>
          <div class="trust-row">
            <span class="trust-label">Treasury</span>
            <span class="trust-status-unverified">‚ö†Ô∏è Unknown</span>
          </div>
        </div>

        <button class="btn" onclick="connectWallet()">Connect Wallet (WalletConnect)</button>
        <button class="btn btn-outline" onclick="showPage('loginPage')" style="margin-left:0;">Back</button>
      </div>
    </div>

    <!-- REPORT SCAM -->
    <div id="reportScam" class="page">
      <div class="panel">
        <h2>Report Suspicious Activity</h2>
        
        <p><span class="highlight">EthosiFi does not investigate or punish scams.</span> We provide tools to help you report verified on-chain misconduct to the appropriate authorities.</p>

        <h3>Step 1: Verify On-Chain Evidence</h3>
        <p>Only report if you have <strong>on-chain proof</strong>, such as:</p>
        <ul>
          <li>LP unlocked prematurely</li>
          <li>Treasury drained from non-Gnosis wallet</li>
          <li>Fake team impersonation (ENS/SIWE mismatch)</li>
        </ul>

        <h3>Step 2: Submit to Authorities</h3>
        <p>EthosiFi routes reports to official channels:</p>
        <div style="background:rgba(0,0,0,0.3); padding:1rem; border-radius:10px; margin:1rem 0;">
          <strong>For Ethereum/Base:</strong><br>
          ‚Ä¢ <a href="https://support.metamask.io/report-scam/" target="_blank">MetaMask Scam Reporting</a><br>
          ‚Ä¢ <a href="https://chainabuse.com" target="_blank">ChainAbuse (Blockchain Intel)</a>
        </div>

        <h3>Step 3: Optional ‚Äî Notify EthosiFi</h3>
        <p>We may use this data to <strong>adjust Ethoscan Scores</strong> (not for enforcement):</p>
        <div class="form-group">
          <label>Project Name or Address</label>
          <input type="text" placeholder="e.g., 0x... or projectname.eth">
        </div>
        <div class="form-group">
          <label>On-Chain Evidence (Tx Hash, ENS, etc.)</label>
          <textarea rows="3" placeholder="Paste transaction hash or verification link"></textarea>
        </div>
        <div class="form-group">
          <label>Your Contact (Optional)</label>
          <input type="email" placeholder="you@example.com">
        </div>
        <button class="btn" onclick="submitReport()">Submit for Review</button>
        <button class="btn btn-outline" onclick="showPage('loginPage')" style="margin-left:0;">Back</button>
      </div>
    </div>

    <!-- VERIFY WALLET -->
    <div id="verifyWallet" class="page">
      <div class="panel">
        <h2>Ethoscan Wallet Verifier</h2>
        <p>Enter a project wallet or token address to check its Ethoscan Score.</p>
        
        <div class="form-group">
          <label>Wallet Address</label>
          <input type="text" id="verifyAddress" placeholder="0x..." />
        </div>
        
        <button class="btn" onclick="runVerification()">Verify Integrity</button>
        <button class="btn btn-outline" onclick="showPage('loginPage')">Back</button>

        <div id="verificationResult" style="margin-top: 1.5rem; display: none;">
          <h3>Verification Report</h3>
          <div id="reportContent"></div>
        </div>
      </div>
    </div>

    <div class="footer">
      ¬© 2026 EthosiFi Protocol ‚Äî Building the immune system for Web4.<br>
      Ethoscan Genesis Score Standard v0.1 | ENS: ethosifi.eth
    </div>
  </div>

  <script>
    // ===== ETHOSCAN VERIFIER =====
    class EthoscanVerifier {
      constructor() {
        this.provider = new ethers.providers.JsonRpcProvider("https://mainnet.base.org");
      }

      async verify(address) {
        const result = {
          address,
          score: 0,
          maxScore: 500,
          tier: "Unverified",
          pillars: {
            teamTransparency: { verified: false, points: 0 },
            fairLaunchPledge: { verified: false, points: 0 },
            liquidityCommitment: { verified: false, points: 0 },
            treasuryTransparency: { verified: false, points: 0 }
          },
          risks: [],
          warnings: []
        };

        try {
          // Treasury: Check if Gnosis Safe
          const code = await this.provider.getCode(address);
          if (code !== "0x") {
            try {
              const safe = new ethers.Contract(
                address,
                ["function getOwners() view returns (address[])"],
                this.provider
              );
              const owners = await safe.getOwners();
              if (owners.length >= 3) {
                result.pillars.treasuryTransparency = { verified: true, points: 150 };
              } else {
                result.warnings.push(`Gnosis Safe has only ${owners.length} signers (<3)`);
              }
            } catch (e) {
              result.risks.push("Contract is not a Gnosis Safe");
            }
          } else {
            result.risks.push("Wallet is EOA ‚Äî not multi-sig treasury");
          }

          // Simulated good addresses for demo
          const goodAddresses = [
            "0x742d35cc6634c0532925a3b8d4c9db4c2b6d9126"
          ].map(a => a.toLowerCase());

          const isGood = goodAddresses.includes(address.toLowerCase());
          
          if (isGood) {
            result.pillars.liquidityCommitment = { verified: true, points: 150 };
            result.pillars.teamTransparency = { verified: true, points: 100 };
            result.pillars.fairLaunchPledge = { verified: true, points: 100 };
          }

          result.score = Object.values(result.pillars).reduce((sum, p) => sum + p.points, 0);
          result.tier = this.getTier(result.score);

          if (result.score < 200) result.risks.push("High scam risk: Insufficient trust signals");

        } catch (err) {
          console.error("Verification failed:", err);
          result.warnings.push("Verification error: " + (err.message || "unknown"));
        }

        return result;
      }

      getTier(score) {
        if (score >= 350) return "‚úÖ Verified Builder";
        if (score >= 200) return "üü° Emerging Builder";
        return "‚ö†Ô∏è Unverified";
      }
    }

    let verifier = null;

    function runVerification() {
      const input = document.getElementById('verifyAddress').value.trim();
      if (!ethers.utils.isAddress(input)) {
        alert("Please enter a valid Ethereum address.");
        return;
      }

      if (!verifier) verifier = new EthoscanVerifier();

      const resultDiv = document.getElementById('reportContent');
      const container = document.getElementById('verificationResult');
      container.style.display = 'block';
      resultDiv.innerHTML = '<p>Verifying... (this may take 10-20 seconds)</p>';

      verifier.verify(input).then(report => {
        let html = `
          <div style="background:rgba(10,18,35,0.7); padding:1.2rem; border-radius:12px; margin:1rem 0;">
            <div><strong>Address:</strong> ${report.address}</div>
            <div><strong>Score:</strong> <span style="color:#6ee7b7; font-weight:bold;">${report.score}/500</span></div>
            <div><strong>Tier:</strong> ${report.tier}</div>
          </div>
          
          <h4>Trust Pillars</h4>
          <div class="trust-row"><span>Team Transparency</span><span>${report.pillars.teamTransparency.verified ? '‚úÖ' : '‚ùå'}</span></div>
          <div class="trust-row"><span>Fair Launch Pledge</span><span>${report.pillars.fairLaunchPledge.verified ? '‚úÖ' : '‚ùå'}</span></div>
          <div class="trust-row"><span>Liquidity Commitment</span><span>${report.pillars.liquidityCommitment.verified ? '‚úÖ' : '‚ùå'}</span></div>
          <div class="trust-row"><span>Treasury Transparency</span><span>${report.pillars.treasuryTransparency.verified ? '‚úÖ' : '‚ùå'}</span></div>
        `;

        if (report.risks.length) {
          html += `<h4 style="color:#f87171;">Risks</h4><ul>`;
          report.risks.forEach(r => html += `<li>${r}</li>`);
          html += `</ul>`;
        }

        if (report.warnings.length) {
          html += `<h4>Warnings</h4><ul>`;
          report.warnings.forEach(w => html += `<li>${w}</li>`);
          html += `</ul>`;
        }

        resultDiv.innerHTML = html;
      }).catch(err => {
        resultDiv.innerHTML = `<p style="color:#f87171;">Error: ${err.message || 'Verification failed'}</p>`;
      });
    }

    // ===== PAGE NAVIGATION =====
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      const target = document.getElementById(pageId);
      if (target) {
        target.classList.add('active');
      }
    }

    function connectWallet() {
      alert("‚úÖ Wallet connected via WalletConnect!\n(Real integration coming on X1 testnet)");
    }

    function submitReport() {
      alert("‚úÖ Report submitted.\n\nNote: EthosiFi does not take enforcement action. We may use this data to update Ethoscan Scores based on on-chain verification.");
      showPage('loginPage');
    }

    // ===== MATRIX RAIN =====
    (function() {
      const canvas = document.getElementById('matrixCanvas');
      const ctx = canvas.getContext('2d');

      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);

      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$%&@#";
      const charArray = chars.split('');
      const fontSize = 14;
      const columns = Math.floor(canvas.width / fontSize);
      const drops = [];

      for (let i = 0; i < columns; i++) {
        drops[i] = Math.random() * -100;
      }

      function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.03)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#6ee7b7';
        ctx.font = `500 ${fontSize}px monospace`;

        for (let i = 0; i < drops.length; i++) {
          const text = charArray[Math.floor(Math.random() * charArray.length)];
          ctx.fillText(text, i * fontSize, drops[i] * fontSize);
          if (drops[i] * fontSize > canvas.height && Math.random() > 0.993) {
            drops[i] = 0;
          }
          drops[i] += 0.45;
        }
      }

      function animate() { draw(); requestAnimationFrame(animate); }
      animate();
    })();
  </script>
</body>
</html>
